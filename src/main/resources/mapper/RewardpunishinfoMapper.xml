<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.student_serve.mapper.RewardpunishinfoMapper">

    <resultMap id="BaseResultMap" type="com.student_serve.model.entity.Rewardpunishinfo">
        <id property="id" column="id" jdbcType="BIGINT"/>
        <result property="sid" column="sid" jdbcType="VARCHAR"/>
        <result property="tid" column="tid" jdbcType="VARCHAR"/>
        <result property="fileId" column="fileId" jdbcType="VARCHAR"/>
        <result property="fileName" column="fileName" jdbcType="VARCHAR"/>
        <result property="state" column="state" jdbcType="VARCHAR"/>
        <result property="filePath" column="filePath" jdbcType="VARCHAR"/>
        <result property="fileUnit" column="fileUnit" jdbcType="VARCHAR"/>
        <result property="tname" column="tname" jdbcType="VARCHAR"/>
        <result property="fileTime" column="fileTime" jdbcType="TIMESTAMP"/>
        <result property="submitTime" column="submitTime" jdbcType="TIMESTAMP"/>
        <result property="checkTime" column="checkTime" jdbcType="TIMESTAMP"/>
        <result property="stime" column="stime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <sql id="Base_Column_List">
        id
        ,sid,tid,
        fileId,fileName,state,
        filePath,fileUnit,tname,
        fileTime,submitTime,checkTime,
        stime
    </sql>

    <select id="queryPRByTeacher" parameterType="com.student_serve.model.dto.rewardPunishInfo.PRInfoQueryRequest"
            resultType="com.student_serve.model.vo.PRInfoVO">
        select pr.*,u.userName,u.department,u.classes from rewardPunishInfo pr left join user u on pr.sid =
        u.userAccount
        <where>
            <if test="form.userAccount != null and form.userAccount != ''">
                pr.sid like concat('%',#{form.userAccount},'%')
            </if>
            <if test="form.state != null and form.state != ''">
                and pr.state = #{form.state}
            </if>
            <if test="form.fileInfo != null and form.fileInfo != ''">
                and pr.fileInfo = #{form.fileInfo}
            </if>
            <if test="form.classes != null and form.classes != ''">
                and u.classes like concat('%',#{form.classes},'%')
            </if>
            <if test="form.stime != null and form.stime != ''">
                and pr.stime = #{form.stime}
            </if>
        </where>
    </select>
</mapper>
